<div>
  <div class="text-center" ng-show="testing">
    <div><i class="fa fa-4x fa-spin fa-smooth fa-spinner"></i></div>
    <div>Testing...</div>
  </div>
  <div class="container-fluid" ng-form="form" ng-show="!testing" ng-submit="ctrl.accept()" novalidate>
    <div class="form-group" title="The title for the layer">
      <label for="title">Title</label>
      <input unique-provider-title type="text" class="form-control" name="title" ng-disabled="!edit"
          ng-model="config.label" ng-required="true" ng-maxlength="1000">
      <small class="form-text text-danger" ng-if="form.title.$error.maxlength">Title is too long!</small>
      <small class="form-text text-danger" ng-if="form.title.$error.unique">Title is not unique!</small>
      <small class="form-text text-muted" ng-if="form.title.$valid || form.title.$error.required">
        Please enter a title <span ng-if="typeName">for the XYZ map layer</span>
      </small>
    </div>

    <div class="form-group" title="The URL for the server">
      <label for="url" class="pr-2">URL</label>
      <button class="btn btn-primary" type="button"
          ng-click="ctrl.launchHelp(typeName)"
          ng-if="ctrl.helpUi"
          title="Help for server specific URL formats">
        <i class="fa fa-fw fa-question-circle"></i>
      </button>
      <input type="text" name="url" class="form-control" ng-disabled="!edit" ng-model="config.url" ng-required="true"
          ng-maxlength="1000">
      <small class="form-text text-danger" ng-if="form.url.$error.maxlength">URL is too long!</small>
      <small class="form-text text-muted" ng-if="form.url.$valid || form.url.$error.required">
        Please enter a URL <span ng-if="urlExample">(e.g. {{urlExample}})</span>
      </small>
    </div>

    <!-- projection string field -->
    <div class="form-group" title="The projection for the server" ng-if="ctrl.projections">
      <label for="url" class="pr-2">Projection</label>
      <popover x-title="'Projection'" content="help.projection" pos="'right'"></popover>
      <select class="custom-select" ng-model="config.projection"
        ng-options="item.code + ' ' + item.title for item in ctrl.projections track by item.code"
        ng-change="ctrl.onProjectionChange()">
      </select>
      <small class="form-text text-danger" ng-if="form.url.$error.maxlength">Projection is too long!</small>
      <small class="form-text text-muted" ng-if="form.url.$valid || form.url.$error.required">
        Please select a projection
      </small>
    </div>
    <!-- min zoom int field -->
    <div class="form-group col-4 float-left pl-0" title="The minimum zoom for the server">
      <label for="url" class="pr-2">Minimum Zoom</label>
      <popover x-title="'Minimum Zoom'" content="help.minZoom" pos="'right'"></popover>
      <input type="text" name="minZoom" class="form-control" ng-disabled="!edit" ng-model="config.minZoom" ng-required="true"
          ng-maxlength="1000">
      <small class="form-text text-danger" ng-if="form.url.$error.maxlength">Minimum zoom is too long!</small>
      <!-- TBD: add default value -->
      <small class="form-text text-muted" ng-if="form.url.$valid || form.url.$error.required">
        Please enter a minimum zoom value
      </small>
    </div>
    <!-- max zoom int field -->
    <div class="form-group col-4 float-left pl-0" title="The maximum zoom for the server">
      <label for="url" class="pr-2">Maximum Zoom</label>
      <popover x-title="'Maximum Zoom'" content="help.maxZoom" pos="'right'"></popover>
      <input type="text" name="maxZoom" class="form-control" ng-disabled="!edit" ng-model="config.maxZoom" ng-required="true"
          ng-maxlength="1000">
      <small class="form-text text-danger" ng-if="form.url.$error.maxlength">Maximum zoom is too long!</small>
      <!-- TBD: add default value -->
      <small class="form-text text-muted" ng-if="form.url.$valid || form.url.$error.required">
        Please enter a maximum zoom value
      </small>
    </div>
    <!-- zoom offset int field -->
    <div class="form-group col-4 float-left pl-0" title="The zoom offset for the server">
      <label for="url" class="pr-2">Zoom Offset</label>
      <popover x-title="'Zoom Offset'" content="help.zoomOffset" pos="'right'"></popover>
      <input type="text" name="zoomOffset" class="form-control" ng-disabled="!edit" ng-model="config.zoomOffset" ng-required="true"
          ng-maxlength="1000">
      <small class="form-text text-danger" ng-if="form.url.$error.maxlength">Zoom offset is too long!</small>
      <!-- TBD: add default value -->
      <small class="form-text text-muted" ng-if="form.url.$valid || form.url.$error.required">
        Please enter a zoom offset
      </small>
    </div>

    <input type="submit" hidden>
    <div class="alert alert-danger" ng-if="error">
      <h5>Error!</h5>
      <p ng-bind-html="error" class="m-0"></p>
    </div>
  </div>
</div>
